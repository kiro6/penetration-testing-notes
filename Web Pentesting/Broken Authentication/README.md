
# methodology 


## Login Brute Forcing

### 1)Check for default credentials

### 2) Check weak brute-force protection
#### - bypass CAPTCHA 
- Do not send the parameter related to the CAPTCHA.
    - Change from POST to GET or other HTTP Verbs
    - Change to JSON or from JSON
- Send the **CAPTCHA parameter empty**.
- Check if the value of the captcha is **in the source code** of the page.
- Check if the value is **inside a cookie.**
- Try to use an **old captcha value**
- Check if you can use the **same** captcha **value** several times with **the same or different sessionID.**
- If the captcha consists on a **mathematical operation** try to **automate** the **calculation.**
- If the captcha consists of **read characters from an image**, check manually or with code **how many images** are being used and if only a **few images are being used, detect them by MD5.** 

#### - rate limit
- rate limit automation 
#### - user-agent block or whitelist user-agents
- try diffrient user-agents
#### - ip block or whitelist ip 
##### Rewrite IP source:
- X-Originating-IP: 127.0.0.1
- X-Forwarded-For: 127.0.0.1
- X-Forwarded: 127.0.0.1
- Forwarded-For: 127.0.0.1
- X-Forwarded-Host: 127.0.0.1
- X-Remote-IP: 127.0.0.1
- X-Remote-Addr: 127.0.0.1
- X-ProxyUser-Ip: 127.0.0.1
- X-Original-URL: 127.0.0.1
- Client-IP: 127.0.0.1
- X-Client-IP: 127.0.0.1
- X-Host: 127.0.0.1
- True-Client-IP: 127.0.0.1
- Cluster-Client-IP: 127.0.0.1
- X-ProxyUser-Ip: 127.0.0.1
- Via: 1.0 fred, 1.1 127.0.0.1
- Connection: close, X-Forwarded-For (Check [hop-by-hop headers](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/abusing-hop-by-hop-headers.md))
##### Rewrite location:
- X-Original-URL: /admin/console
- X-Rewrite-URL: /admin/console



### 3)Brute Forcing Usernames 
#### check any functionality that can reveal user names exist of not 
- message functionality
- login , register and Password Reset forms

#### types of check 
- User Unknown Attack
- Timing attack 
- Username Existence Inference ( ex : Prefill the username input value if the username is valid )
- Predictable Usernames

#### sub-addressing extension

sub-addressing. This extension, defined at RFC5233, says that any +tag in the left part of an email address should be ignored by the Mail Transport Agent (MTA) and used as a tag for sieve filters.
This means that writing to an email address like student+htb@hackthebox.eu will deliver the email to student@hackthebox.eu and, if filters are supported and properly configured, will be placed in folder htb. Very few web applications respect this RFC, which leads to the possibility of registering almost infinite users by using a tag and only one actual email address.


### 4)Brute Forcing Passwords
#### Password Policy Inference
- register form can directly tell you the policy
- using this methdology

| Tried     | Password                | Lower | Upper | Digit | Special | >=8chars | >=20chars |
|-----------|-------------------------|-------|-------|-------|---------|----------|-----------|
| Yes/No    | qwerty                  | X     |       |       |         |          |           |
| Yes/No    | Qwerty                  | X     | X     |       |         |          |           |
| Yes/No    | Qwerty1                 | X     | X     | X     |         |          |           |
| Yes/No    | Qwertyu1                | X     | X     | X     |         | X        |           |
| Yes/No    | Qwert1!                 | X     | X     | X     | X       |          |           |
| Yes/No    | Qwerty1!                | X     | X     | X     | X       | X        |           |
| Yes/No    | QWERTY1                 |       | X     | X     |         |          |           |
| Yes/No    | QWERT1!                 |       | X     | X     | X       |          |           |
| Yes/No    | QWERTY1!                |       | X     | X     | X       | X        |           |
| Yes/No    | Qwerty!                 | X     | X     |       | X       |          |           |
| Yes/No    | Qwertyuiop12345!@#$%    | X     | X     | X     | X       | X        | X         |


### 5)Predictable Reset Token
- Check Weak Token Generation (ex:using epoch time and username to produce hash)
- Check Short Tokens
- Check Weak Cryptography and Encoding 
- Check Reset Token as Temp Password Reuse


## Password Attacks
- Guessable Answers for questions as proof of identity and then setting a new one password
- Username/UserID Parameter Injection (IDOR) in Reset password to change password for another user 


## Session Attacks
- Session Cookie token tampering
- Check Remember me token
- Decrypt or Decode token
- Check Weak(short/predictable) session token
- Check Token Lifetime => try Session Fixation
- Check Token in URL=> Referer header , Server logs

## mass assignment
- ex : inject paramter `isAdmin=true`

## HTTP Verb Tampering
- try different verbs on every function 
