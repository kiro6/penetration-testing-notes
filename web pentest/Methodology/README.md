# Recon and Info Gathering 

- Network range
    - reverse lookup
    - https://whois.domaintools.com/

- subdomain collecting
    - subfinder
    - assetfinder
    - crt.sh 
    - shodan
    - google dorks
    - gau 
    - bruteforce subdomains
        - dnsrecon
    - check which is alive and which is not 
        - httpx

- collecting dirs and routes
    - katana 
    - check robots.txt 

- collecting paramters
    - paramspider
    - gau

- collecting js files
    - jsfinder 

- search for secrets in js files 
    - mantra 
    - SecretFinder

- search for secrets in services like github, jenkis, s3 bucket,etc.... 
    - trufflehog

- search for hidden dirs and routes
    - ffuf
    - feroxbuster  

- search for hidden files 
    - dirsearch
    - ffuf

- search for hidden paramters 
    - arjun




# Logic vuln

## Broken Access Control 
1) client-side controls: test if u can bypass restrictions which only implemented in client side

    EX: 
    - if u can not change your email address from the frontend but u can do it from burpsuite
2) Insufficient workflow validation: when developer expect you to go in the designed flow but u can manpluate implemented
    
    EX: 
    - Skipping form steps: A user can submit a form without filling out required fields because validation assumes all steps were followed
3) Broken Object Level Authorization: Test if u can access an object that you are not auth to access it 
    
    EX: 
    - if u have student role check if can access exams which is only allowed to techers
4) Broken Function Level Authorization: Test if u can access a function you are not auth to access it 
    
    EX: 
    - if u have student role check if can access create class function which is only allowed to teachers
5) Broken Object Property Level Authorization: this is when you have access to specific Properties of an object but not all Test if u can access other Properties
    
    EX:
    - if u are testing a blog website and have access to posts that are created by ohter users but the api reveals ohter senstive info like Emails and location
    - if u can add admin=1 in the request to access admin Property and be an admin  
6) Unrestricted Access to Sensitive Business Flows: Test if u can use a legite function in a malicious manner and there is no limitations
    
    EX:
    - if u are testing a cinema website u can automate the ticket reservation for all movies and deny other people from reserving their seats 
    - if u are a student and have a code to join a class , u can try to add infinte number of fake students to this class 




7) 403 bypass
    - IP-based Access Control: 
        - X-Originating-IP: 127.0.0.1
        - X-Forwarded-For: 127.0.0.1
        - X-Forwarded: 127.0.0.1
        - Forwarded-For: 127.0.0.1
        - X-Forwarded-Host: 127.0.0.1
        - X-Remote-IP: 127.0.0.1
        - X-Remote-Addr: 127.0.0.1
        - X-ProxyUser-Ip: 127.0.0.1
        - X-Original-URL: 127.0.0.1
        - Client-IP: 127.0.0.1
        - X-Client-IP: 127.0.0.1
        - X-Host: 127.0.0.1
        - True-Client-IP: 127.0.0.1
        - Cluster-Client-IP: 127.0.0.1
        - X-ProxyUser-Ip: 127.0.0.1
        - Via: 1.0 fred, 1.1 127.0.0.1

    - URL-based Access Control
        - Rewrite location:
            - X-Original-URL: /admin/console
            - X-Rewrite-URL: /admin/console

    - Apache ACL bypass: check [Orange's Blog](https://blog.orange.tw/posts/2024-08-confusion-attacks-en/#%E2%9A%94%EF%B8%8F-https://blog.orange.tw/posts/2024-08-confusion-attacks-en/#%E2%9A%94%EF%B8%8F-Primitive-1-2-ACL-Bypass)
        
        EX: 
        - http://server/admin.php%3Fooo.php
    - Nginx ACL bypass : check [hacktricks](https://book.hacktricks.xyz/pentesting-web/proxy-waf-protections-bypass#heading-pathname-manipulation-bypassing-reverse-proxies-and-load-balancers-security-rules)
        
        EX: 
        - http://server/admin.php/index.php
    - URL-matching Discrepancies
        - site.com/secret –> HTTP 403 Forbidden
        - site.com/SECRET –> HTTP 200 OK
        - site.com/secret/ –> HTTP 200 OK
        - site.com/secret/. –> HTTP 200 OK
        - site.com//secret// –> HTTP 200 OK
        - site.com/./secret/.. –> HTTP 200 OK
        - site.com/;/secret –> HTTP 200 OK
        - site.com/.;/secret –> HTTP 200 OK
        - site.com//;//secret –> HTTP 200 OK
        - site.com/secret.json –> HTTP 200 OK (ruby)
        - site.com/secret.anything -> HTTP 200 OK
 
### Notes:
1) try diffrent http methods PUT,GET,POST,OPTIONS,DELETE,...etc on the same endpoint
2) try diffrent deleviry approaches json,xml,application/x-www-form-urlencoded
3) check this for json manpluation https://github.com/Az0x7/vulnerability-Checklist/blob/main/Json%20Attack/json.md


## Broken Authentication
1) Check for default credentials
2) Check weak brute-force protection
    1. Bypass CAPTCHA    
        - Do not send the parameter related to the CAPTCHA.
             - Change from POST to GET or other HTTP Verbs
             - Change to JSON or from JSON
        - Send the CAPTCHA parameter empty.
        - Check if the value of the captcha is in the source code of the page.
        - Check if the value is inside a cookie.
        - Try to use an old captcha value
        - Check if you can use the same captcha value several times with the same or different sessionID.
        - If the captcha consists on a mathematical operation try to automate the calculation.
        - If the captcha consists of read characters from an image, check manually or with code how many images are being used and if only a few images are being used, detect them by MD5.
    2. Bypass Rate limit
        - Race Condtion
        - automation
    3. user-agent block or whitelist user-agents
        - try diffrient user-agents
    4. ip block or whitelist ip
        - Rewrite IP source:
            - X-Originating-IP: 127.0.0.1
            - X-Forwarded-For: 127.0.0.1
            - X-Forwarded: 127.0.0.1
            - Forwarded-For: 127.0.0.1
            - X-Forwarded-Host: 127.0.0.1
            - X-Remote-IP: 127.0.0.1
            - X-Remote-Addr: 127.0.0.1
            - X-ProxyUser-Ip: 127.0.0.1
            - X-Original-URL: 127.0.0.1
            - Client-IP: 127.0.0.1
            - X-Client-IP: 127.0.0.1
            - X-Host: 127.0.0.1
            - True-Client-IP: 127.0.0.1
            - Cluster-Client-IP: 127.0.0.1
            - X-ProxyUser-Ip: 127.0.0.1
            - Via: 1.0 fred, 1.1 127.0.0.1
    5. Rewrite location:
        - X-Original-URL: /admin/console
        - X-Rewrite-URL: /admin/console

3) Brute Forcing Usernames: check any functionality that can reveal user names exist or not
    - message functionality
    - login , register and Password Reset forms

4) Session Fixation
    1. obtain a valid session identifier
    2. fixate a valid session identifier, this can happen if :
        - The assigned session identifier pre-login remains the same post-login
        - Session identifiers (such as cookies) are being accepted from URL Query Strings or Post Data and propagated to the application
    3. deliver to the victim

5) 2FA bypass
    - bruteforce OTP
    - Reusable Codes
    - 2FA Code Leakage in Response: Check the response of the 2FA Code Triggering Request to see if the code is leaked.
    - CSRF on 2FA Disabling: No CSRF Protection on disabling 2FA, also there is no auth confirmation.
    - Password Reset Disable 2FA: 2FA gets disabled on password change/email change.

6) OAuth bypass 
    - Flawed CSRF protection (no state param)
    - Referer Header leaking Code + State
    - Leaking authorization codes and access tokens by Flawed redirect_uri validation
    - Stealing OAuth access tokens via an open redirect
    - Client Secret Bruteforce
    - pre account take over 
        - login using victim email without email verfication, when the victim use try to login or register using oauth u can access his account 
        - use oauth to login with your account, change the email to victim email, when the victim try to login or register may u can access his account
    - OpenID ssrf using logo_uri
    - for more details and attacks check [Kiro_Maged's Oauth notes](https://github.com/kiro6/penetration-testing-notes/tree/main/web%20pentest/OAuth%202.0%20attacks#vulnerabilities-in-the-client-application)

7) Waek Reset Password function 
    - no csrf protection
    - idor or BAC to change another user's password

8) jwt attacks
    - Accepting arbitrary signatures
    - Accepting tokens with no signature
    - Brute-forcing secret keys
    - Injecting self-signed JWTs via the jwk parameter
    - Injecting self-signed JWTs via the jku parameter
    - Injecting self-signed JWTs via the kid parameter
    - Algorithm confusion attacks 
    - for more details check [Kiro_Maged's Jwt attacks notes ](https://github.com/kiro6/penetration-testing-notes/tree/main/web%20pentest/JWT%20attacks)



# Injection Vulnerabilities.

- Test for host header Injection (HHI)
- Command Injection
- SQL Injection
- NoSQL Injection
- Cross Side Scripting (XSS)
- CSS injection
- Format String Injection
- XML (XXE) Injection
- XSLT Injection
- XPATH Injection
- LDAP Injection 
- Server Side Template Injection (SSTI)
- CSV Injection
- CRLF Injection
- Server Side Include Injection (old systems)
- Edge-Side Includes Injection (old systems)


# Misconf 

- Cross-site request forgery (CSRF)
- Cross-origin resource sharing (CORS) 
- Missing security headers
    EX: 
    - Strict-Transport-Security (HSTS)
    - Content Security Policy (CSP)
    - HttpOnly
    - X-Frame-Options
- Exposed Debugging or Error Information
    EX: 
    - laravel panel
    - Django Debug Page
- Directory Listing Enabled
- Weak Transport Layer Security (TLS) Configuration
    - https://www.ssllabs.com/ssltest/ 
    - https://www.immuniweb.com/
- Old or Outdated Components
    - wappalyzer
- Insufficient Session Expiration
- DNS Misconfigurations
    - subdomain takeover 
- Improper Security Settings in Cloud Environments
    EX: 
    - check s3 bucket permssions 
        - aws-cli
- Dependency Confusion


# Server Side
- Command Injection 
- SSRF
    - DNS Rebinding
- Insecure File Upload 
- File Inclustion
- Race conditions
- Insecure deserialization
- Prototype pollution
- Insecure deserialization
- HTTP request smuggling
- Web cache poisoning
- DOS & Redos
- GraphQL Attacks
