# Content 
- [FTP](#ftp)
  - [Service Info](#service-info)
  - [Attacks](#attacks)   
- [SMB](#smb)



# FTP
File Transfer Protocol

## Service Info
### ports used  
- 21/TCP for control channel
- 20/TCP for data channel in active mode
- for passive mode the server tell the client which port to connect
### Dangerous Settings
| Setting                      | Description                                              |
|------------------------------|----------------------------------------------------------|
| anonymous_enable=YES         | Allowing anonymous login?                               |
| anon_upload_enable=YES       | Allowing anonymous to upload files?                     |
| anon_mkdir_write_enable=YES  | Allowing anonymous to create new directories?           |
| no_anon_password=YES         | Do not ask anonymous for password?                      |
| anon_root=/home/username/ftp| Directory for anonymous.                                 |
| write_enable=YES             | Allow the usage of FTP commands: STOR, DELE, RNFR, RNTO, MKD, RMD, APPE, and SITE? |

### Footprinting the Service
- nmap 
```bash
sudo nmap -sV -p21 -sC -A 10.129.14.136

sudo nmap -sV -p21 -sC -A 10.129.14.136 --script ftp*
```
### Service Interaction
- **Tools***
```bash
# ftp
ftp 10.129.14.136

# netcat
nc -nv 10.129.14.136 21

# telnet
telnet 10.129.14.136 21

# openssl
openssl s_client -connect 10.129.14.136:21 -starttls ftp
```
- **commands**

| Command | Description                                                                                               |
|---------|-----------------------------------------------------------------------------------------------------------|
| connect | Sets the remote host, and optionally the port, for file transfers.                                         |
| get     | Transfers a file or set of files from the remote host to the local host.                                     |
| put     | Transfers a file or set of files from the local host onto the remote host.                                   |
| quit    | Exits tftp.                                                                                                |
| status  | Shows the current status of tftp, including the current transfer mode (ascii or binary), connection status, time-out value, and so on. |
| verbose | Turns verbose mode, which displays additional information during file transfer, on or off.                  |

- **Download All Available Files**
```bash
wget -m --no-passive ftp://anonymous:anonymous@10.129.14.136
```
## Attacks 
### Bruteforce 
```bash
# hydra
hydra -l username -P /path/to/password-list.txt ftp://target-ip
hydra -L /path/to/usernames.txt -P /path/to/password-list.txt ftp://192.168.1.10

# medusa 
medusa -h target-ip -u username -P /path/to/password-list.txt -M ftp
medusa -h 192.168.1.10 -U /path/to/usernames.txt -P /path/to/password-list.txt -M ftp
```

### Anonymous Login
```bash
ftp target-ip
  Name (target-ip:your-username): anonymous
  Password: [press Enter or type any email as a password]
```

### CVEs
```bash
sudo nmap -sV -p21 -sC -A 10.129.14.136 --script ftp*
searchsploit 'ftp' # search for version 
```
